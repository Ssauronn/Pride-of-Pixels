UNITS AI
________

GENERAL AI
Task Queue:
	- Workers can be commanded to queue up resource gathering as well as attack commands
	- All other units can be commanded to move to a series of points in a row, alongside attacking units/buildings in a specific order.

Patrol:
	- Patrol setting for any unit, with a patrol path set up via patrol points
	- Option to loop the patrol or not. Set by default to loop.
	- Any other commands cancel the patrol.

Aggressive/Defensive/Stand Ground:
	- Aggressive:
		- Attacks any enemy within range
		- Does not stop attacking
	- Defensive:
		- Attacks any enemy within range
		- Stops chasing and returns to origin point after chasing a set distance
	- Stand Ground:
		- Only attacks enemies within the unit's attack range
		- Will not move for any reason except direct commands

Target(s) to Focus in Combat:
	- Icon for every unit type available on the enemy's team, whether or not the unit type is built or unlocked.
		- Click once to Toggle between modes
			- Focus: Shimmering gold border, with a blade icon adjacent.
				- The nearest units of any/all Focus targets will be targeted first
			- Neutral: No additions to the icon.
				- The unit will neither be focused or avoided.
			- Avoid: Red bar around the icon, with a crossed out blade icon adjacent.
				- If any units are in combat other than the avoided units, they'll be focused first.

Formation:
	- Line, Square, Hollow Square
		- All of this is already done, just needs to be able to be adjusted now in game, on the fly.



BASIC UNIT SPECIFICS
Soldier:
	- No specifics needed.

Knight:
	- Shielding Aura:
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if in combat and the ability's cooldown is available.
				- Does not cast if a Shielding Aura from a different friendly unit is already active.
				- Does not stack with other Shielding Auras from other Knights.

Berserker:
	- Enrage:
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if in combat and the ability's cooldown is available.
	- (TECH ONLY) Recklessness: Leap:
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if in combat, the ability's cooldown is available, and the Berserker is out of
			  attack range.
				- Does not cast if it's target is currently in attack range.

Rogue:
	- Invisibility:
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if outside of combat.
				- If the Rogue deals damage, Invisibility is cancelled.
				- If the Rogue takes damage, Invisibility is cancelled.
	- Ambush:
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if in combat, the Rogue is currently in or outside of combat, the Rogue is
			  within attack range, and the Rogue is currently Invisible.
				- Automatically applied to any attack made while Invisible if unlocked.
			- Targets nearest enemy if Assassin is not unlocked.
			- Targets nearest enemy that has a current HP pool less than Ambush damage if
			  Assassin is unlocked.
	- (TECH ONLY) Stealth: Assassin:
		- Passive ability, toggle with Right Click to turn off/on
			- While toggled, shimmering gold border around the icon.
			- Activates automatically on Ambush cast as long as ability is off cooldown.

Ranger:
	- No specifics needed.



RUBY UNIT SPECIFICS
Abomination (MAGIC ONLY):
	- No specifics needed.

Automaton (TECH ONLY):
	- Tachyon Bombardment:
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if in combat, and within range of 3 or more enemy units and buildings.
	- Shocktroopers:
		- Active ability, not able to be Auto Cast.
		- CPU AI set to cast at nearest enemy if all of the following are true:
			- Number of enemy units and buildings combined outnumbers the number of allied units
			  and buildings combined by more than 1.2x.
				- Prevents needless teleportations for fights that the CPU has a fair chance of
				  winning.
			- Enough Automatons are under control to turn the fight to less than a 1.2x numbers
			  advantage for the enemy.
				- Prevents teleporting Automatons to a fight they'll lose and die in because the
				  numbers advantage is not significantly affected.
			- An allied unit or building is in combat and has taken recent damage.
				- Prevents teleporting Automatons to the nearest enemy army if they're within
				  sight but not acting aggressive.

Acolyte:
	- Heal
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if not in combat and the friendly unit it's targeting is not in combat.
				- Focuses units with the lowest numerical HP value first.
				- Can be commanded to heal a specific unit, in which case the Acolyte will not
				  stop healing that unit until either of them enter combat, or it's target reaches
				  100% HP.
	- (MAGIC ONLY) Vitality Linked:
		- Active ability, requires 3 total Acolytes. Combine into one immovable formation. Not able
		  to be auto cast.
		- FORMATION
			- CPU AI set to form 3 Acolytes into Vitality Linked once if all of the following are true:
				- There are no Acolytes controlled that are currently in a Vitality Linked formation.
					- This prevents all Acolytes from being converted and no Acolytes left to normally
					  heal.
				- There are more than 3 Acolytes controlled.
					- This prevents the first 3 Acolytes from immediately being converted into Vitality
					  Linked formation.
					- This ensures that a Vitality Linked formation forms relatively quickly, but not
					  immediately.
		- VITALITY LINKED HEAL
			- CPU AI set to cast Vitality Linked heal if all of the following are true:
				- There are Acolytes controlled that are currently in a Vitality Linked Formation.
					- Impossible to cast otherwise.
				- The unit(s) to heal are not outnumbered by more than 1.2x.
					- Prevents a heal from being wasted on a fight that is likely lost.
				- If target is a single unit, the target is missing more HP than it's enemy but will
				  have more HP than it's enemy once it's healed.
					- Ensures that a heal on a single unit is almost guaranteed to save the unit's life.
				- If target location is a group of friendly units, 2+ targets are missing HP, and at
				  least one of the targets will not be overhealed.
					- Ensures that the heal on a group affects more than a single unit.
					- Ensures that the heal on a group will not be immediately wasted once 2+ units
					  take the smallest amount of damage.
	- (TECH ONLY) Blessed Aura:
		- Passive ability, able to be auto cast
			- While toggled, shimmering gold border around the icon.
			- Always automatically toggled, must be manually un-toggled.
	- (TECH ONLY) Searing Field:
		- Passive ability, able to be auto cast
			- While toggled, shimmering gold border around the icon.
			- Always automatically toggled, must be manually un-toggled.
			
Subverter:
	- Aggressive/Defensive/Stand Ground:
		- The Subverter has no normal attacks, and even special 'attacks' must be cast manually. If
		  the Subverter is attacked, it resorts to a fleeing behavior identical to Civilians. If the
		  Subverter is commanded to attack, it moves to its target, and then casts Disable if its
		  target is a Building. It will not ever cast Explode automatically (if Explode is unlocked)
		  and Explode must always be manually clicked by a player, or purposefully triggered by the
		  AI.
	- Copy:
		- Active ability, not able to be Auto Cast.
			- Casts if not in combat, an enemy unit is visible anywhere on the map, and the enemy unit
			  is not a Subverter.
				- After casting, moves to the location of any known enemy building locations that match
				  the team of the unit that was copied.
					- Patrols within a set distance in a zone directly around the building.
					- Prioritizes buildings that the enemy unit originated from. E.g., the enemy unit
					  copied is an Abomination, so the Subverter prioritizes moving to the location of
					  the enemy Temple's location.
						- If the enemy units' origin building location is not known, prioritizes any
						  other building type.
							- If the enemy units' origin building location is ever found, re-prioritizes
							  the enemy units' origin building location and moves there.
					- If no building locations on the enemy team are yet known, the Subverter patrols
					  near the location that the enemy unit it copied its appearance from was seen
					  when it copied its appearance.
						- If a building on the enemy team is ever found, re-prioritizes buildings as
						  locations to move to and follows the aforementioned behavior on building
						  prioritization.
	- Disable:
		- Active ability, toggle with Right Click to turn on Auto Cast.
			- While toggled, shimmering gold border around the icon.
			- Casts if off cooldown and target is an enemy building.
				- Walks away from the Disabled building after casting Disable.
					- Prioritizes standing nearby other units of the same type if within a min/max
					  range.
						- Stays within a minimum and maximum distance. The normal "wander" range is
						  simply expanded during this time, and the minimum wander range is changed
						  from the building walls to a minimum distance outwards.
						- This is to prevent players from checking whatever unit is standing by to
						  easily find the Subverter.
					- Returns to its regular patrol distance a short time before Disable's cooldown
					  becomes available again.
						- This is to prevent players from noticing a unit rushing a building
						  immediately before it's disabled. 
	- (TECH ONLY) Explode:
		- Active ability, not able to be Auto Cast.
			- Casts if (1) a 'High Value Target' is within range, and will be killed by Explode's
			  damage, (2) or casts if the Subverter is in combat and is low health and has more enemy
			  units and buildings within range than friendly units and buildings within range, (3) or
			  casts if friendly units are nearby and in combat with an enemy group (more than 1 enemy
			  unit) and the Subverter can align itself to Explode more than 1 enemy unit without
			  hitting friendly units.
				(1): 'High Value Targets' determined through complex AI decision making.
					- Subverter will Explode on a High Value Target as soon as it's within range
					  nearly disregarding the number of friendly units and/or buildings within range.
					  The decision to do so should be based on a number of variables:
						- The resource cost and time cost of each FRIENDLY unit/building within range
						  that will be killed as a result.
						- The resource cost of the High Value Target to replace for the enemy.
						- The time cost of the High Value Target to replace for the enemy.
						- The liklihood of any nearby friendly units from winning the fight.
							- Based simply on numbers. If a friendly army is nearby and the number
							  of friendly units outnumbers the number of enemy units by more than 1.2x,
							  it's likely the friendly army will win and the Subverter should not use
							  Explode.
				(2): This is a suicide tactic, to prevent the Subverter from dying without making an
					 impact. Simply the number of nearby enemy units and buildings should far outnumber
					 the number of friendly units and buildings within Explode's range. If this isn't
					 the case, the Subverter should not cast Explode.
				(3): This is a combat tactic, to add value to a team fight that is otherwise an even
					 fight to help turn the tide. This decision is only considered if nearby friendly
					 units and buildings have a relatively even count compared to nearby enemy units
					 and buildings. The Subverter will not cast Explode if any friendly units are
					 within range here.
	
Wizard:
	- Fireball:
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if off cooldown.
				- Fireball deals more damage than the Wizard's basic attack (Magic Missiles) and so it
				  should be used regardless of whether the AoE effect will hit other enemies or not.
	- (MAGIC ONLY) Fire Linked:
		- Active ability, requires 3 total Wizards. Combine into one immovable formation. Not able
		  to be auto cast.
		- FORMATION
			- CPU AI set to form 3 Acolytes into Fire Linked if all of the following are true:
				- There are more than 3 controlled Wizards not currently in a Fire Linked formation.
					- This does allow for multiple Fire Linked formations to appear, as long as a Wizard
					  is still active and under control that isn't part of a Fire Linked formation after
					  the next formation is created.
				- After the first is created, there are slowly increasing requirements to form the next
				  Fire Link.
					- E.g. after the first Fire Linked formation, there must be 2 Wizards active in
					  addition to the next 3 that will be used in the next Fire Link. After the third
					  Fire Link, there must be 3 Wizards active in addition to the next 3 that will be
					  used in the next Fire Link, and so on.
		- FIRE LINKED METEOR
			- CPU AI set to cast Fire Linked meteors if all of the following are true:
				- There are Wizards controlled that are currently in a Fire Linked formation.
					- Impossible to cast otherwise.
				- The target is not a solo unit.
					- The requirement must increase by 1 unit as each additional Fire Linked formation
					  is created. Target count must equal 1 + n, where n is the number of Fire Linked
					  formations active and under control.
				- The target is near allied units.
					- This prevents hitting enemies that are nowhere near being threatened, and then
					  just retreating and immediately healing all of the damage taken.
				- Prioritizes lower health targets.
					- The goal is not only poke damage but to secure kills that are otherwise out of
					  reach.
	- (TECH ONLY) Redirect:
		- Active ability, toggle with Right Click to turn on Auto Cast
			- While toggled, shimmering gold border around the icon.
			- Casts if off cooldown, friendly target has very recently taken damage, friendly target
			  has enemy units within ranged unit range, a friendly Knight is within range, the friendly
			  target is over 1/4 HP, the friendly target is not a Knight, and the Knight to Redirect 
			  to is over 1/2 HP.
				- Prioritizes units with the most enemy units within range.
					- If there's a tie, compare number of enemy units within melee range, and
					  prioritize the friendly unit that has more units in melee range.
						- If there's still a tie, cast Redirect on the unit that most recently took
						  damage.
				- If no friendly units have very recently taken damage, cast Redirect on a friendly
				  unit that has an enemy unit within melee range, and which enemy unit is not a Worker.
					- This avoids Wizards from needlessly casting Redirect on friendly units that are
					  attacking enemy Workers.
				- Does not Redirect a Knight to a Knight to avoid absurd resist values and weird
				  interactions.

Warlock: 
	- Summon Demon:
		- Active ability, toggle with Right Click to turn on Auto Cast.
			- While toggled, shimmering gold border around the icon.
			- Casts if off cooldown and there is either 1) no currently summoned Demon, 2) less Demons
			  summoned than the Warlock's maximum amount allowed, or 3) a Demon currently summoned is
			  not in combat and is less than 100% HP.
				(1): Warlocks by default can have 1 Demon summoned, so if none are currently summoned,
					 then the Warlock will summon a Demon.
				(2): (MAGIC ONLY) Warlocks can be upgraded by choosing Ritual Grounds and then the Mass
					 Enslavement upgrade from the Ritual Grounds to allow up to 3 Demons to be summoned.
				(3): Demons do not regenerate HP on their own. If a Demon is summoned and the maximum
					 amount of Demons summoned is already active, the Demon with the least HP attached
					 to the summoning Warlock will be immediately destroyed, thereby replacing it with
					 a Demon with full HP.

Demon: 
	- Movement: Locked within a specific range to move away from the Warlock the Demon is attached to.
		- Demons can be commanded by real players to move further away from the attached Warlock than is
		  allowed, which will begin the countdown to death for the Demon unless it re-enters range of
		  the Warlock, but CPU AI will never choose to do this.
			- If a Demon is far enough away to begin the Death timer but is currently being commanded to
			  move to a location within a safe distance of the attached Warlock, the Demon should not
			  attempt to find a new location and allow itself to be outside of range, so long as the
			  current command remains getting within range of its attached Warlock.



